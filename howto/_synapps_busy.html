
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>synApps busy record &#8212; APS Bluesky Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'howto/_synapps_busy';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="synApps sscan as 1D Flyer" href="_synapps_sscan_1d_flyer.html" />
    <link rel="prev" title="Plot x, y data from a databroker run" href="_plot_x_y_databroker.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">APS Bluesky Training</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../instrument/index.html">
    Instrument
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../example/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    How-To Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutor/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../changes.html">
    Changes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../instrument/index.html">
    Instrument
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../example/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    How-To Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutor/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../changes.html">
    Changes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="bluesky_cheat_sheet.html">Bluesky Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="_ad_v_motors.html">Scan Area Detector v. Motor</a></li>
<li class="toctree-l1"><a class="reference internal" href="_after_measurement.html">Accessing data later, after the measurement</a></li>
<li class="toctree-l1"><a class="reference internal" href="_basic_aps_info.html">APS Accelerator Information for Beamlines</a></li>
<li class="toctree-l1"><a class="reference internal" href="_basic_motor_scaler_scan.html">Minimal: Scan scaler <em>vs</em> motor</a></li>
<li class="toctree-l1"><a class="reference internal" href="_bluesky_queueserver.html">First steps with bluesky-queueserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="_count_scaler.html">Count the scaler</a></li>
<li class="toctree-l1"><a class="reference internal" href="_custom_heater_positioner.html">Heater Simulation using synApps epid and transform records</a></li>
<li class="toctree-l1"><a class="reference internal" href="_custom_plan.html">Custom bluesky plan</a></li>

<li class="toctree-l1"><a class="reference internal" href="_doodle.html">Linux Command &amp; Wait for Finish</a></li>
<li class="toctree-l1"><a class="reference internal" href="_dynamic_limits_2motor.html">Dynamic Limits for Two Motors</a></li>
<li class="toctree-l1"><a class="reference internal" href="_epics_proc_field.html">Trigger a Device with the EPICS record .PROC field</a></li>
<li class="toctree-l1"><a class="reference internal" href="_images_darks_flats.html">Images, Darks, &amp; whites with EPICS area detector, ophyd, and Bluesky</a></li>
<li class="toctree-l1"><a class="reference internal" href="_lineup_1d_peak.html">Lineup a 1-D peak : scan detector <em>v</em> motor</a></li>
<li class="toctree-l1"><a class="reference internal" href="_locate_image_peak.html">Locate peak on 2-D area detector image</a></li>
<li class="toctree-l1"><a class="reference internal" href="_plot_x_y_databroker.html">Plot x, y data from a databroker run</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">synApps <em>busy</em> record</a></li>
<li class="toctree-l1"><a class="reference internal" href="_synapps_sscan_1d_flyer.html">synApps <em>sscan</em> as 1D Flyer</a></li>
<li class="toctree-l1"><a class="reference internal" href="_temperature_controller_swait.html">Simulate a temperature controller with an EPICS <code class="docutils literal notranslate"><span class="pre">swait</span></code> record</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">How-To Guides</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">synApps...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="synApps-busy-record">
<h1>synApps <em>busy</em> record<a class="headerlink" href="#synApps-busy-record" title="Link to this heading">#</a></h1>
<p><strong>Objective</strong></p>
<p>In this notebook, we show how to use the EPICS <em>busy</em> record.</p>
<p>The synApps <a class="reference external" href="https://epics.anl.gov/bcda/synApps/busy/busyRecord.html">busy record</a> is used to signal the completion of an operation. Generally, the <em>busy</em> record is used for operations that have no inherent means of reporting that a long or complex operation has completed. Two cases come to mind immediately, both involving waiting for completion of some operation):</p>
<ul class="simple">
<li><p>arbitrary operation</p></li>
<li><p>movement of a positioner (or set of positioners such as a diffractometer or hexapod)</p></li>
</ul>
<p>One type of positioner, the EPICS <em>motor</em> record, already has such a means to report done moving, via the <code class="docutils literal notranslate"><span class="pre">.DMOV</span></code> field, so the <em>busy</em> record provides no additional benefit. But a set of simpler PVs (using <em>ao</em>, <em>ai</em>, <em>bo</em>, &amp; <em>bi</em> records), which together implement the main features of a positioner, would benefit from having a <em>done moving</em> signal. This is a case for use of a <em>busy</em> record.</p>
<p>This notebook expects an EPICS IOC with prefix <code class="docutils literal notranslate"><span class="pre">gp:</span></code> that provides several PVs:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>PV</p></th>
<th class="head"><p>record type</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:bit1</span></code></p></td>
<td><p>bo</p></td>
<td><p>general purpose binary output (bit) variable</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:float1</span></code></p></td>
<td><p>ao</p></td>
<td><p>general purpose analog output (floating-point) variable</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:float2</span></code></p></td>
<td><p>ao</p></td>
<td><p>general purpose floating-point (floating-point) variable</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}mybusy1</span></code></p></td>
<td><p>busy</p></td>
<td><p>general purpose busy record</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}mybusy2</span></code></p></td>
<td><p>busy</p></td>
<td><p>general purpose busy record</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">instrument</span></code> package is not necessary. This notebook will use a <a class="reference external" href="https://blueskyproject.io/databroker/generated/databroker.temp.html?highlight=temp#databroker.temp">temporary databroker catalog</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">xmode</span> Minimal
<span class="kn">from</span> <span class="nn">apstools.synApps</span> <span class="kn">import</span> <span class="n">BusyRecord</span>
<span class="kn">from</span> <span class="nn">apstools.utils</span> <span class="kn">import</span> <span class="n">run_in_thread</span>
<span class="kn">from</span> <span class="nn">bluesky</span> <span class="kn">import</span> <span class="n">plans</span> <span class="k">as</span> <span class="n">bp</span>
<span class="kn">from</span> <span class="nn">bluesky</span> <span class="kn">import</span> <span class="n">plan_stubs</span> <span class="k">as</span> <span class="n">bps</span>
<span class="kn">from</span> <span class="nn">bluesky.callbacks.best_effort</span> <span class="kn">import</span> <span class="n">BestEffortCallback</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">Component</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">Device</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">EpicsSignal</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">PVPositioner</span>
<span class="kn">from</span> <span class="nn">ophyd</span> <span class="kn">import</span> <span class="n">Signal</span>
<span class="kn">from</span> <span class="nn">ophyd.status</span> <span class="kn">import</span> <span class="n">DeviceStatus</span>

<span class="kn">import</span> <span class="nn">bluesky</span>
<span class="kn">import</span> <span class="nn">databroker</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">IOC</span> <span class="o">=</span> <span class="s2">&quot;gp:&quot;</span>

<span class="n">cat</span> <span class="o">=</span> <span class="n">databroker</span><span class="o">.</span><span class="n">temp</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">RE</span> <span class="o">=</span> <span class="n">bluesky</span><span class="o">.</span><span class="n">RunEngine</span><span class="p">({})</span>
<span class="n">RE</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">insert</span><span class="p">)</span>
<span class="n">RE</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">BestEffortCallback</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Exception reporting mode: Minimal
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
<section id="arbitrary-operation">
<h2>arbitrary operation<a class="headerlink" href="#arbitrary-operation" title="Link to this heading">#</a></h2>
<p>Use a <em>busy</em> record to indicate the state of some arbitrary operation. A <em>fly</em> scan is one example. In this example, a user-adjustable time delay is sued to simulate the arbitrary operation.</p>
<p>The <em>apstools</em> package provides support for the <em>busy</em> record, <code class="docutils literal notranslate"><span class="pre">apstools.synApps.BusyRecord</span></code>.</p>
<section id="operation-uses-trigger()-method">
<h3><em>operation</em> uses <code class="docutils literal notranslate"><span class="pre">trigger()</span></code> method<a class="headerlink" href="#operation-uses-trigger()-method" title="Link to this heading">#</a></h3>
<p>Let’s start with a Device with a <em>busy</em> PV and a user-settable delay time. The <em>operation</em> is run (in an external thread) from the device’s <code class="docutils literal notranslate"><span class="pre">.trigger()</span></code> method.</p>
<p>Follow example from <a class="reference external" href="https://blueskyproject.io/ophyd/explanations/status.html?highlight=devicestatus">https://blueskyproject.io/ophyd/explanations/status.html?highlight=devicestatus</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">OperatorBase</span><span class="p">(</span><span class="n">Device</span><span class="p">):</span>
    <span class="n">busy</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">BusyRecord</span><span class="p">,</span> <span class="s2">&quot;mybusy1&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;omitted&quot;</span><span class="p">)</span>
    <span class="n">delay_time_s</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">Signal</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hinted&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">check_busy</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">old_value</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="s2">&quot;Mark as finished when *busy* changes from Busy to Done.&quot;</span>
            <span class="k">if</span> <span class="n">old_value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Busy&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Done&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">busy</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">clear_sub</span><span class="p">(</span><span class="n">check_busy</span><span class="p">)</span>
                <span class="n">status</span><span class="o">.</span><span class="n">set_finished</span><span class="p">()</span>

        <span class="nd">@run_in_thread</span>
        <span class="k">def</span> <span class="nf">simulated_operation</span><span class="p">():</span>
            <span class="c1"># simulate how the external process works</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">busy</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Busy&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_time_s</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">busy</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>

        <span class="n">status</span> <span class="o">=</span> <span class="n">DeviceStatus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">busy</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">busy</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">check_busy</span><span class="p">)</span>
        <span class="n">simulated_operation</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">status</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">operator</span> <span class="o">=</span> <span class="n">OperatorBase</span><span class="p">(</span><span class="n">IOC</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;operator&quot;</span><span class="p">)</span>
<span class="n">operator</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="n">operator</span><span class="o">.</span><span class="n">stage_sigs</span><span class="p">[</span><span class="s2">&quot;delay_time_s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">operator</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;operator_delay_time_s&#39;,
              {&#39;value&#39;: 2, &#39;timestamp&#39;: 1681482822.6680264})])
</pre></div></div>
</div>
<p>Run the operation by calling the <code class="docutils literal notranslate"><span class="pre">operation.trigger()</span></code> method. Since that method returns a status object (used by the RunEngine to wait for the trigger method to complete), grab that status object. Use that to wait for the trigger method to complete. Report elapsed time, as well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  <span class="c1"># time the trigger()</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>  <span class="c1"># trigger() returns a status object</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">st</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">st</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># default time, since device was not staged</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.013 st = DeviceStatus(device=operator_busy_state, done=False, success=False)
2.020 st = DeviceStatus(device=operator_busy_state, done=True, success=True)
</pre></div></div>
</div>
<p>Now, run <code class="docutils literal notranslate"><span class="pre">count()</span></code> (one of the bluesky.plans) with the <code class="docutils literal notranslate"><span class="pre">operator</span></code> device as a “detector”. The standard plans take care of staging, triggering, reading, and unstaging the device. A RunEngine subscription by the <code class="docutils literal notranslate"><span class="pre">BestEffortCallback</span></code> is responsible for generating the <code class="docutils literal notranslate"><span class="pre">LiveTable</span></code> view.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">count</span><span class="p">([</span><span class="n">operator</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Transient Scan ID: 1     Time: 2023-04-14 09:33:44
Persistent Unique Scan ID: &#39;fb42dc41-560a-4ef1-8830-c06d44103fad&#39;
New stream: &#39;primary&#39;
+-----------+------------+-----------------------+
|   seq_num |       time | operator_delay_time_s |
+-----------+------------+-----------------------+
|         1 | 09:33:45.9 |                 1.000 |
+-----------+------------+-----------------------+
generator count [&#39;fb42dc41&#39;] (scan num: 1)



</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;fb42dc41-560a-4ef1-8830-c06d44103fad&#39;,)
</pre></div></div>
</div>
</section>
</section>
<section id="positioner-movement">
<h2>positioner movement<a class="headerlink" href="#positioner-movement" title="Link to this heading">#</a></h2>
<p>Use a <em>busy</em> record to signal <em>done moving</em> for a positioner built from separate PVs (using <code class="docutils literal notranslate"><span class="pre">ophyd.PVPositioner</span></code>).</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>PV</p></th>
<th class="head"><p>PVPositioner attribute</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:bit1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stop_signal</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:float1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">setpoint</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:float2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">readback</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}gp:float2.PREC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">precision</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{IOC}mybusy2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">done</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>TODO: Discuss the implementation (Here, we connect to mybusy2 as EpicsSignal)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">Mover</span><span class="p">(</span><span class="n">PVPositioner</span><span class="p">):</span>
    <span class="n">setpoint</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">EpicsSignal</span><span class="p">,</span> <span class="s2">&quot;gp:float1&quot;</span><span class="p">)</span>
    <span class="n">readback</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">EpicsSignal</span><span class="p">,</span> <span class="s2">&quot;gp:float2&quot;</span><span class="p">)</span>
    <span class="n">done</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">EpicsSignal</span><span class="p">,</span> <span class="s2">&quot;mybusy2&quot;</span><span class="p">)</span>
    <span class="n">done_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">stop_signal</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">EpicsSignal</span><span class="p">,</span> <span class="s2">&quot;gp:bit1&quot;</span><span class="p">)</span>
    <span class="n">stop_value</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">Component</span><span class="p">(</span><span class="n">EpicsSignal</span><span class="p">,</span> <span class="s2">&quot;gp:float2.PREC&quot;</span><span class="p">)</span>

    <span class="n">simulator_sleep_s</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.001</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">in_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setpoint</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">abs_tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">done_value</span>

    <span class="nd">@run_in_thread</span>
    <span class="k">def</span> <span class="nf">setpoint_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_done</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">done_value</span><span class="p">)</span>

    <span class="nd">@run_in_thread</span>
    <span class="k">def</span> <span class="nf">motion_simulator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate the motion using Python code.&quot;&quot;&quot;</span>
        <span class="n">reset_stop_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_value</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_position</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_done</span><span class="p">:</span>
                <span class="c1"># finish the move to the exact setpoint value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setpoint</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">done_value</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simulator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_done</span><span class="w"> </span><span class="si">= }</span><span class="s2"> end&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_position</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_signal</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_value</span><span class="p">:</span>
                    <span class="c1"># must STOP the move now, stay at current position</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setpoint</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stop_signal</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">reset_stop_value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">done_value</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simulator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="si">= }</span><span class="s2"> stopped&quot;</span><span class="p">)</span>

                <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpoint</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">:</span>
                    <span class="c1"># move closer to the setpoint</span>
                    <span class="n">step</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># novel step size</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">readback</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simulator:  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="si">=}</span><span class="s2">  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_done</span><span class="si">=}</span><span class="s2">  </span><span class="si">{</span><span class="n">diff</span><span class="si">=}</span><span class="s2">  </span><span class="si">{</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator_sleep_s</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># update tolerance based on display precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setpoint</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setpoint_watch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_simulator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mover</span> <span class="o">=</span> <span class="n">Mover</span><span class="p">(</span><span class="n">IOC</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mover&quot;</span><span class="p">)</span>
<span class="n">mover</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator: self.readback.get() = 1.0 self.is_done = True end
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">mover</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">mover</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">mover</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">-</span><span class="n">mover</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">mover</span><span class="o">.</span><span class="n">position</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">elapsed</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-2.0  value=0.0
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-1.0  value=-0.5
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.5  value=-0.75
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.25  value=-0.875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.125  value=-0.9375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0625  value=-0.96875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.03125  value=-0.984375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.015625  value=-0.9921875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0078125  value=-0.99609375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00390625  value=-0.998046875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.001953125  value=-0.9990234375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0009765625  value=-0.99951171875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00048828125  value=-0.999755859375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.000244140625  value=-0.9998779296875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0001220703125  value=-0.99993896484375
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0  mover.position = -1.0 st.elapsed = 1.6434977054595947
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator: self.readback.get() = -1.0 self.is_done = True end
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=2.0  value=0.0
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=1.0  value=0.5
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.5  value=0.75
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.25  value=0.875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.125  value=0.9375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0625  value=0.96875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.03125  value=0.984375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.015625  value=0.9921875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0078125  value=0.99609375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.00390625  value=0.998046875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.001953125  value=0.9990234375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0009765625  value=0.99951171875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.00048828125  value=0.999755859375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.000244140625  value=0.9998779296875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0001220703125  value=0.99993896484375
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1  mover.position = 1.0 st.elapsed = 1.5773115158081055
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator: self.readback.get() = 1.0 self.is_done = True end
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-2.0  value=0.0
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-1.0  value=-0.5
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.5  value=-0.75
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.25  value=-0.875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.125  value=-0.9375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0625  value=-0.96875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.03125  value=-0.984375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.015625  value=-0.9921875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0078125  value=-0.99609375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00390625  value=-0.998046875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.001953125  value=-0.9990234375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0009765625  value=-0.99951171875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00048828125  value=-0.999755859375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.000244140625  value=-0.9998779296875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0001220703125  value=-0.99993896484375
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2  mover.position = -1.0 st.elapsed = 1.5689060688018799
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator: self.readback.get() = -1.0 self.is_done = True end
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">n_moves</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">yield from</span> <span class="n">bps</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="n">mover</span><span class="p">,</span> <span class="o">-</span><span class="n">mover</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>

<span class="n">RE</span><span class="p">(</span><span class="n">n_moves</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=2.0  value=0.0
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=1.0  value=0.5
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.5  value=0.75
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.25  value=0.875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.125  value=0.9375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0625  value=0.96875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.03125  value=0.984375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.015625  value=0.9921875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0078125  value=0.99609375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.00390625  value=0.998046875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.001953125  value=0.9990234375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0009765625  value=0.99951171875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.00048828125  value=0.999755859375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.000244140625  value=0.9998779296875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=0.0001220703125  value=0.99993896484375
INFO:__main__:simulator: self.readback.get() = 1.0 self.is_done = True end
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-2.0  value=0.0
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-1.0  value=-0.5
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.5  value=-0.75
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.25  value=-0.875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.125  value=-0.9375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0625  value=-0.96875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.03125  value=-0.984375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.015625  value=-0.9921875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0078125  value=-0.99609375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00390625  value=-0.998046875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.001953125  value=-0.9990234375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0009765625  value=-0.99951171875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.00048828125  value=-0.999755859375
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.000244140625  value=-0.9998779296875
INFO:__main__:simulator:  self.tolerance=0.0001  self.is_done=False  diff=-0.0001220703125  value=-0.99993896484375
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
()
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:__main__:simulator: self.readback.get() = -1.0 self.is_done = True end
</pre></div></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="_plot_x_y_databroker.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Plot x, y data from a databroker run</p>
      </div>
    </a>
    <a class="right-next"
       href="_synapps_sscan_1d_flyer.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">synApps <em>sscan</em> as 1D Flyer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arbitrary-operation">arbitrary operation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operation-uses-trigger()-method"><em>operation</em> uses <code class="docutils literal notranslate"><span class="pre">trigger()</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#positioner-movement">positioner movement</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/howto/_synapps_busy.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, APS BCDA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>