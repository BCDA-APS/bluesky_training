

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Bluesky: Brief Introduction &#8212; APS Bluesky Training  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IPython Profile" href="_ipython.html" />
    <link rel="prev" title="Using Git for version control" href="_git-help.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">APS Bluesky Training  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../howto/index.html">
                        How-To Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../instrument/index.html">
                        Instrument
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../example/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutor/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changes.html">
                        Changes
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../howto/index.html">
                        How-To Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../instrument/index.html">
                        Instrument
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../example/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutor/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changes.html">
                        Changes
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="_FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="_aps_data_management.html">APS Data Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="_create_conda_env.html">Create bluesky environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="_git-help.html">Using Git for version control</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Bluesky: Brief Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="_ipython.html">IPython Profile</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Bluesky: Brief Introduction</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="bluesky-brief-introduction">
<h1>Bluesky: Brief Introduction<a class="headerlink" href="#bluesky-brief-introduction" title="Permalink to this heading">#</a></h1>
<p><em>Bluesky</em> is a Python framework for instrument control &amp; scientific data
acquisition, primarily using EPICS.</p>
<p>(Based on a <a class="reference external" href="https://anl.box.com/s/l506pozlzjvy8d5ttjxq3a1fev4q2z6h">2021 slide set</a> prepared for the APS Spectroscopy SIG.  Other slide sets are available in <a class="reference external" href="https://anl.box.com/s/kityevv6n9x7ngll99z53acy76bp64ys">ANL’s Box folder</a>.)</p>
<details>
<summary>Abstract</summary>
The Bluesky framework provides Python tools for coordinating measurement
steps with data acquisition, analysis, and visualization.  For data
acquisition, it relies on the popular PyEpics library to connect with
the instrument control system.  For measurements, it provides a set of
standard scanning plans as well as provisions to customize or build your
own as needs dictate.  Visualization for data acquisition is provided
through the matplotlib package and Qt while for analysis, packages such
as dask, pandas, and others may be used.  Data may be exported in a
variety of formats with existing tools or into a different format with
your own tool.  As used at APS, primary data will be stored in a mongodb
database for each instrument with Python tools available for retrieval
and catalogging.
</details>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>Improve the experimental efficiency of our users.</p>
<p><em>A huge part of my job is to set these experiments up for success.</em>
(Mary Upton, Physicist, APS Instrument Scientist)</p>
<ul class="simple">
<li><p>EPICS for instrument controls</p></li>
<li><p>Bluesky framework:</p>
<ul>
<li><p>sequence the X-ray measurements</p></li>
<li><p>collect &amp; coordinate data &amp; metadata</p></li>
<li><p>access the data after the measurement for analysis</p></li>
<li><p>export the data for other tools or offsite use</p></li>
</ul>
</li>
</ul>
</section>
<section id="principal-parts-of-the-bluesky-framework">
<h2>Principal parts of The Bluesky framework<a class="headerlink" href="#principal-parts-of-the-bluesky-framework" title="Permalink to this heading">#</a></h2>
<p><img alt="Bluesky Diagram" src="../_images/bluesky-overview-white-no-heading.png" /></p>
<ul class="simple">
<li><p><a class="reference external" href="https://blueskyproject.io/ophyd/"><strong>ophyd</strong></a></p>
<ul>
<li><p>Hardware Abstraction Layer</p></li>
<li><p>Signals &amp; Devices with human-friendly names that propagate into metadata</p></li>
<li><p>Talks to <a class="reference external" href="https://epics.anl.gov/">EPICS</a> via <a class="reference external" href="https://pyepics.github.io/pyepics/">PyEpics</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://blueskyproject.io/bluesky/"><strong>bluesky</strong></a></p>
<ul>
<li><p>Orchestrate the scan</p></li>
<li><p>Collect &amp; publish data (plot, table, database, file, socket, …)</p></li>
<li><p>Basic data visualization</p></li>
<li><p>Handle interruptions (no beam, shutter closed, …)</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://blueskyproject.io/databroker/"><strong>databroker</strong></a></p>
<ul>
<li><p>Rich search &amp; access to saved data</p></li>
<li><p>Separates data from file format</p></li>
<li><p>Discoverable data repositories</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://apstools.readthedocs.io/"><strong>apstools</strong></a></p>
<ul>
<li><p>Various Python tools for use with Bluesky at the APS</p></li>
<li><p>synApps Devices &amp; APS-specific Devices (undulator, shutter, …)</p></li>
<li><p>APS storage ring <code class="docutils literal notranslate"><span class="pre">current</span></code></p></li>
<li><p>Information from APS Proposal and ESAF databases</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.mongodb.com/"><strong>MongoDB</strong></a></p>
<ul>
<li><p>Database (used by <strong>databroker</strong>) that stores lightweight (non-image) data. metadata, and references to image files.</p></li>
<li><p>Data is stored as documents in <a class="reference external" href="https://www.w3schools.com/whatis/whatis_json.asp">JSON</a> (text) format.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://blueskyproject.io/tiled/"><strong>tiled</strong></a></p>
<ul>
<li><p>Data access service (uses <strong>databroker</strong>, URLs, or file systems) for stored (not live) data.</p></li>
<li><p>Call by URI, Python, or command line interfaces.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://blueskyproject.io/bluesky-queueserver/"><strong>queueserver</strong></a></p>
<ul>
<li><p>Provides the <strong>bluesky</strong> <code class="docutils literal notranslate"><span class="pre">RunEngine</span></code> as a network service.</p></li>
<li><p>Use Python or JSON interface with ZMQ or command line.</p></li>
</ul>
</li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>info</p></th>
<th class="head"><p>web address</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Docs</p></td>
<td><p>https://blueskyproject.io/</p></td>
</tr>
<tr class="row-odd"><td><p>Code</p></td>
<td><p>https://github.com/bluesky/</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">apstools</span></code></p></td>
<td><p>https://github.com/BCDA-APS/apstools/</p></td>
</tr>
</tbody>
</table>
</section>
<section id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Measurements are controlled by the <code class="docutils literal notranslate"><span class="pre">bluesky.RunEngine</span></code> as plans</p>
<ul>
<li><p>Plans are defined by Python functions</p></li>
<li><p>Collected data is published:</p>
<ul>
<li><p><strong>databroker</strong> for storage</p></li>
<li><p>Subscribers (callbacks) for visualization, export, and other</p></li>
</ul>
</li>
<li><p>Use standard plans or construct your own custom plans</p>
<ul>
<li><p>Embed a plan inside another plan (such as this hypothetical):</p>
<ul>
<li><p>step scan temperature <em>T</em> through a range</p></li>
<li><p>scan <em>$\theta$-$2\theta$</em> at every <em>T</em></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><em>Moveable</em> Devices or Signals can be scanned</p></li>
<li><p><em>Readable</em> Devices or Signals can be detectors</p>
<ul>
<li><p>Devices and Signals are defined by Python classes</p></li>
<li><p>Signals connect with EPICS PVs</p></li>
</ul>
</li>
<li><p>Other Signals can be monitored during a measurement</p></li>
</ul>
</section>
<section id="how-does-bluesky-fit-in">
<h2>How does Bluesky fit in?<a class="headerlink" href="#how-does-bluesky-fit-in" title="Permalink to this heading">#</a></h2>
<p>Bluesky is a user interface for data collection using EPICS.  It can
also interface with other controls (such as native Python, LabView,
network sockets) but these interfaces will require effort to implement.</p>
<p><img alt="control system overview" src="../_images/control-system-diagram.png" /></p>
<ul class="simple">
<li><p>Works with existing EPICS controls (IOCs &amp; PVs)</p>
<ul>
<li><p>even area detectors</p></li>
</ul>
</li>
<li><p>Coordinates data collection and analysis with X-ray experiments</p></li>
<li><p>Works along with existing GUIs</p></li>
<li><p>Pre-built and customized measurement procedures</p></li>
<li><p>Delivers data and metadata for your analysis processes</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="_git-help.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using Git for version control</p>
      </div>
    </a>
    <a class="right-next"
       href="_ipython.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IPython Profile</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-parts-of-the-bluesky-framework">Principal parts of The Bluesky framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-bluesky-fit-in">How does Bluesky fit in?</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/reference/_intro2bluesky.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, APS BCDA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>